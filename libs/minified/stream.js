!function(){"use strict";c.SKIP={},c.lift=function(){var t=arguments[0];return r(Array.prototype.slice.call(arguments,1)).map(function(n){return t.apply(void 0,n)})},c.scan=function(e,r,n){var t=n.map(function(n){var t=e(r,n);return t!==c.SKIP&&(r=t),t});return t(r),t},c.merge=r,c.combine=e,c.scanMerge=function(r,a){var n=r.map(function(n){return n[0]}),t=e(function(){var e=arguments[arguments.length-1];return n.forEach(function(n,t){-1<e.indexOf(n)&&(a=r[t][1](a,n()))}),a},n);return t(a),t},c["fantasy-land/of"]=c;var n=!1;function c(r){var n,a=[],u=[];function i(n){return arguments.length&&n!==c.SKIP&&(r=n,t(i)&&(i.changing(),i.state="active",a.forEach(function(n,t){n(u[t](r))}))),r}return i.constructor=c,i.state=arguments.length&&r!==c.SKIP?"active":"pending",i.parents=[],i.changing=function(){t(i)&&(i.state="changing"),a.forEach(function(n){n.changing()})},i.map=function(n,t){var e="active"===i.state&&t!==c.SKIP?c(n(r)):c();return e.parents.push(i),a.push(e),u.push(n),e},i.toJSON=function(){return null!=r&&"function"==typeof r.toJSON?r.toJSON():r},i["fantasy-land/map"]=i.map,i["fantasy-land/ap"]=function(n){return e(function(n,t){return n()(t())},[n,i])},i.unregisterChild=function(n){var t=a.indexOf(n);-1!==t&&(a.splice(t,1),u.splice(t,1))},Object.defineProperty(i,"end",{get:function(){return n||((n=c()).map(function(n){return!0===n&&(i.parents.forEach(function(n){n.unregisterChild(i)}),i.state="ended",i.parents.length=a.length=u.length=0),n}),n)}}),i}function e(e,r){var a=r.every(function(n){if(n.constructor!==c)throw new Error("Ensure that each item passed to stream.combine/stream.merge/lift is a stream");return"active"===n.state}),u=a?c(e.apply(null,r.concat([r]))):c(),i=[],t=r.map(function(t){return t.map(function(n){return i.push(t),(a||r.every(function(n){return"pending"!==n.state}))&&(a=!0,u(e.apply(null,r.concat([i]))),i=[]),n},c.SKIP)}),o=u.end.map(function(n){!0===n&&(t.forEach(function(n){n.end(!0)}),o.end(!0))});return u}function r(n){return e(function(){return n.map(function(n){return n()})},n)}function t(n){return"pending"===n.state||"active"===n.state||"changing"===n.state}Object.defineProperty(c,"HALT",{get:function(){return n&&console.log("HALT is deprecated and has been renamed to SKIP"),n=!0,c.SKIP}}),"undefined"!=typeof module?module.exports=c:"function"!=typeof window.m||"stream"in window.m?window.m={stream:c}:window.m.stream=c}();
